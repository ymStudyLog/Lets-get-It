<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>계산기</title>
    <style>
        * {box-sizing: border-box}
        #id_result{width: 180px; height: 50px; margin: 5px; text-align: right;}
        #id_operator{width: 50px; height: 50px; margin: 5px; text-align: center;}
        button{width: 50px; height: 50px; margin: 5px; }
    </style>
</head>
<body>
    <input readonly id="id_operator" />
    <input readonly type="number" id="id_result" />
    <div class="row">
        <button id="num-7">7</button>
        <button id="num-8">8</button>
        <button id="num-9">9</button>
        <button id="plus">+</button>
    </div>
    <div class="row">
        <button id="num-4">4</button>
        <button id="num-5">5</button>
        <button id="num-6">6</button>
        <button id="minus">-</button>
    </div>
    <div class="row">
        <button id="num-1">1</button>
        <button id="num-2">2</button>
        <button id="num-3">3</button>
        <button id="divide">/</button>
    </div>
    <div class="row">
        <button id="clear">C</button>
        <button id="num-0">0</button>
        <button id="calculate">=</button>
        <button id="multiply">*</button>
    </div>
    <script>
        //태그 선택자 2개 result/operator. 입력받은 내용 저장할 변수 3개
        const $operator = document.querySelector("#id_operator");        
        const $result = document.querySelector("#id_result");        
        let num1="";
        let op="";
        let num2="";

        /*함수 4가지? 1.숫자 버튼 입력시 2.연산자 입력시 3.=버튼 입력시 4.clear입력시 --> 입력값이 변하면서 절차만 반복하
        는 그런 과정만 함수로 정의하기!!!!!! 숫자 입력 및 연산자 입력할 경우 1,2번만 상수 변수에 함수 정의*/
        //함수가 함수를 반환하는 고차함수 사용 --> 화살표가 연이어서 나올수도 있음.
        //if문 중첩 제거하는 방법을 사용하기.
        const onClickNumber = (event) => {
            if(!op) {
                num1 += event.target.textContent;
                $result.value += event.target.textContent;
                return;
            }
            //여기서부터는 op값이 있을때 실행됨.
            if(!num2) {
                $result.value ="";
            }
            num2 += event.target.textContent;
            $result.value += event.target.textContent;
            
        };

        const onClickOperator = (operator) => () => {
            if(num1) {
                if(num2){
                    switch(op){
                    case '+' :
                        num1 = parseInt(num1) + parseInt(num2);
                        break;
                    case '-' :
                        num1 = num1 - num2;
                        break;
                    case '*' :
                        num1 = num1 * num2;
                        break;
                    case '/' :
                        num1 = num1 / num2;                            
                        break;  
                    default:
                        break;      
                    }
                    $result.value = num1;
                    num2 = "";
                    op = operator;
                    $operator.value = op;
                }
                else {
                    op = operator;
                    $operator.value = op;
                }
            }
            else { 
                alert("숫자를 먼저 입력하세요.");
            }
        };

        /*각각의 버튼에 전부 이벤트 리스너를 이용해 이벤트 연결하기. 
        getElementById를 사용했을때 이상하게 이벤트 리스너를 달면 오류남
        차이점이 뭘까---->?
        getElementById
        querySelector
        우선 이벤트 리스너 달고 입력값만 변하는데 반복되는 것들을 함수로 묶기*/
        document.querySelector("#num-0").addEventListener('click', onClickNumber);
        document.querySelector("#num-1").addEventListener('click', onClickNumber);
        document.querySelector("#num-2").addEventListener('click', onClickNumber);
        document.querySelector("#num-3").addEventListener('click', onClickNumber);
        document.querySelector("#num-4").addEventListener('click', onClickNumber);
        document.querySelector("#num-5").addEventListener('click', onClickNumber);
        document.querySelector("#num-6").addEventListener('click', onClickNumber);
        document.querySelector("#num-7").addEventListener('click', onClickNumber);
        document.querySelector("#num-8").addEventListener('click', onClickNumber);
        document.querySelector("#num-9").addEventListener('click', onClickNumber);
        document.querySelector("#plus").addEventListener('click', onClickOperator('+'));
        document.querySelector("#minus").addEventListener('click', onClickOperator('-'));
        document.querySelector("#divide").addEventListener('click', onClickOperator('/'));
        document.querySelector("#multiply").addEventListener('click', onClickOperator('*'));
        document.querySelector("#calculate").addEventListener('click', () => {
            if(num2){
                switch(op){
                    case '+' :
                        $result.value = parseInt(num1) + parseInt(num2);
                        break;
                    case '-' :
                        $result.value = num1 - num2;
                        break;
                    case '*' :
                        $result.value = num1 * num2;
                        break;
                    case '/' :
                        $result.value = num1 / num2;                            
                        break;  
                    default:
                        break;      
                }
            }
            else
                alert("숫자를 먼저 입력하세요.");
        });
        document.querySelector("#clear").addEventListener('click', () => {
            $operator.value="";
            $result.value="";
            num1="";
            num2="";
            op="";
        });
    </script>    
</body>
</html>